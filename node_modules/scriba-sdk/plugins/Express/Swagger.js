import express from "express";
import swaggerUi from "swagger-ui-express";
import OpenAPI from "./OpenAPI.js";

import { SwaggerTheme, SwaggerThemeNameEnum } from'swagger-themes';
const theme = new SwaggerTheme();

export default function SwaggerUI(scriba, tenantId, themeName = SwaggerThemeNameEnum.DARK) {
    const router = express.Router();

    router.get("/openapi.json", (req, res) => {
        res.json(OpenAPI(scriba, tenantId));
    });

    const swaggerOptions = {
        // explorer: true,
        customCss: `
        .topbar, .info { display: none; }
        ${theme.getBuffer(themeName)}`,
    };

    router.use(
        "/",
        swaggerUi.serve,
        swaggerUi.setup(null, {
            ...swaggerOptions,
            swaggerOptions: {
                url: "openapi.json"
            }
        })
    );

    return router;
}
